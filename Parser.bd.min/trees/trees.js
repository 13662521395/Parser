"use strict";var triggerError=function(t,r,e,a,o){t.triggerEvent("error",{source:r,target:e,errMsg:a,errCode:o})},loadSource=function(t,r){!t.data.controls[r.id]&&r.source.length>1?t.data.controls[r.id]={play:!1,index:1}:t.data.controls[r.id]&&r.source.length>t.data.controls[r.id].index+1&&t.data.controls[r.id].index++,t.setData({controls:t.data.controls})};Component({attached:function(){this._top=getApp()._Parser;var t=!0,r=!1,e=void 0;try{for(var a,o=this.data.nodes[Symbol.iterator]();!(t=(a=o.next()).done);t=!0){var n=a.value;"video"==n.name&&this._top.videoContext.push({id:n.attrs.id,context:swan.createVideoContext(n.attrs.id,this)})}}catch(t){r=!0,e=t}finally{try{!t&&o.return&&o.return()}finally{if(r)throw e}}},properties:{nodes:{type:Array,value:[]},controls:{type:Object,value:{}}},methods:{playEvent:function(t){if(this._top.videoContext.length>1&&this._top.data.autopause){var r=!0,e=!1,a=void 0;try{for(var o,n=this._top.videoContext[Symbol.iterator]();!(r=(o=n.next()).done);r=!0){var i=o.value;i.id!=t.currentTarget.dataset.id&&i.context.pause()}}catch(t){e=!0,a=t}finally{try{!r&&n.return&&n.return()}finally{if(e)throw a}}}},previewEvent:function(t){if(!t.target.dataset.hasOwnProperty("ignore")){var r=!0;this._top.triggerEvent("imgtap",{src:t.currentTarget.dataset.src,ignore:function(){return r=!1}}),r&&this._top.data.autopreview&&swan.previewImage({current:t.currentTarget.dataset.src,urls:this._top.imgList.length?this._top.imgList:[t.currentTarget.dataset.src]})}},tapEvent:function(t){var r=!0;this._top.triggerEvent("linkpress",{href:t.currentTarget.dataset.href,ignore:function(){return r=!1}}),r&&t.currentTarget.dataset.href&&(/^http/.test(t.currentTarget.dataset.href)?this._top.data.autocopy&&swan.setClipboardData({data:t.currentTarget.dataset.href,success:function(){swan.showToast({title:"链接已复制"})}}):swan.navigateTo({url:t.currentTarget.dataset.href}))},adError:function(t){triggerError(this._top,"ad",t.currentTarget,"",t.detail.errorCode)},videoError:function(t){loadSource(this,t.currentTarget.dataset),triggerError(this._top,"video",t.currentTarget,t.detail.errMsg)},audioError:function(t){loadSource(this,t.currentTarget.dataset),triggerError(this._top,"audio",t.currentTarget,t.detail.errMsg)},_loadVideo:function(t){this.data.controls[t.currentTarget.dataset.id]={play:!0,index:0},this.setData({controls:this.data.controls})}}});