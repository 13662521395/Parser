"use strict";function makeMap(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t,s=e.split(","),i=s.length;i--;)a[s[i]]=!0;return a}function bubbling(e){for(var t=e._STACK.length;t--;){if(richOnlyTags[e._STACK[t].name])return!1;e._STACK[t].c=1}return!0}var trustAttrs=makeMap("align,alt,app-id,author,autoplay,border,cellpadding,cellspacing,class,color,colspan,controls,data-src,dir,face,height,href,id,ignore,loop,media,muted,name,path,poster,rowspan,size,span,src,start,style,type,unit-id,unitId,width,xmlns"),trustTags=makeMap("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags=makeMap("address,article,aside,body,center,cite,footer,header,html,nav,pre,section"),ignoreTags=makeMap("area,base,basefont,canvas,circle,command,ellipse,embed,frame,head,iframe,input,isindex,keygen,line,link,map,meta,param,path,polygon,rect,script,source,svg,textarea,track,use,wbr"),richOnlyTags=makeMap("a,colgroup,fieldset,legend,picture,table,tbody,td,tfoot,th,thead,tr"),selfClosingTags=makeMap("area,base,basefont,br,col,circle,ellipse,embed,frame,hr,img,input,isindex,keygen,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),blankChar=makeMap(" , ,\t,\r,\n,\f"),userAgentStyles={a:"color:#366092;word-break:break-all;padding:1.5px 0 1.5px 0",address:"font-style:italic",big:"display:inline;font-size:1.2em",blockquote:"background-color:#f6f6f6;border-left:3px solid #dbdbdb;color:#6c6c6c;padding:5px 0 5px 10px",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",img:"max-width:100%",mark:"background-color:yellow",picture:"max-width:100%",pre:"font-family:monospace;white-space:pre;overflow:scroll",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",u:"text-decoration:underline"},screenWidth=wx.getSystemInfoSync().screenWidth;wx.canIUse("editor")?(makeMap("bdi,bdo,caption,rt,ruby,pre",trustTags),makeMap("bdi,bdo,caption,rt,ruby,pre",richOnlyTags),ignoreTags.rp=!0,blockTags.pre=void 0):blockTags.caption=!0,module.exports={highlight:null,LabelHandler:function(e,t){var a=e.attrs;switch(a.style=t.CssHandler.match(e.name,a,e)+(a.style||""),e.name){case"div":case"p":a.align&&(a.style="text-align:"+a.align+";"+a.style,a.align=void 0);break;case"img":a["data-src"]&&(a.src=a.src||a["data-src"],a["data-src"]=void 0),a.width&&parseInt(a.width)>screenWidth&&(a.style+=";height:auto !important"),a.src&&!a.ignore&&(bubbling(t)?a.i=(t._imgNum++).toString():a.ignore="T");break;case"a":case"ad":bubbling(t);break;case"font":if(a.color&&(a.style="color:"+a.color+";"+a.style,a.color=void 0),a.face&&(a.style="font-family:"+a.face+";"+a.style,a.face=void 0),a.size){var s=parseInt(a.size);s<1?s=1:s>7&&(s=7);var i=["xx-small","x-small","small","medium","large","x-large","xx-large"];a.style="font-size:"+i[s-1]+";"+a.style,a.size=void 0}break;case"video":case"audio":a.id?t["_"+e.name+"Num"]++:a.id=e.name+ ++t["_"+e.name+"Num"],"video"==e.name&&(a.width&&(a.style="width:"+(parseFloat(a.width)+a.width.includes("%")?"%":"px")+";"+a.style,a.width=void 0),a.height&&(a.style="height:"+(parseFloat(a.height)+a.height.includes("%")?"%":"px")+";"+a.style,a.height=void 0),t._videoNum>3&&(e.lazyLoad=!0)),a.source=[],a.src&&a.source.push(a.src),a.controls||a.autoplay||console.warn("存在没有 controls 属性的 "+e.name+" 标签，可能导致无法播放",e),bubbling(t);break;case"source":var r,l=t._STACK[t._STACK.length-1];if(!l||!a.src)break;if("video"==l.name||"audio"==l.name)l.attrs.source.push(a.src);else{var r,n=a.media;"picture"==l.name&&!l.attrs.src&&(!n||n.includes("px")&&(-1!=(r=n.indexOf("min-width"))&&-1!=(r=n.indexOf(":",r+8))&&screenWidth>parseInt(n.substring(r+1))||-1!=(r=n.indexOf("max-width"))&&-1!=(r=n.indexOf(":",r+8))&&screenWidth<parseInt(n.substring(r+1))))&&(l.attrs.src=a.src)}}var o=a.style.split(";"),d={};a.style="";for(var r=0,c=o.length;r<c;r++){var g=o[r].split(":");if(!(g.length<2)){var u=g[0].trim().toLowerCase(),p=g.slice(1).join(":").trim();if(p.includes("url")){var h=p.indexOf("(");if(-1!=h++){for(;'"'==p[h]||"'"==p[h]||blankChar[p[h]];)h++;"/"==p[h]&&("/"==p[h+1]?p=p.substring(0,h)+t._protocol+":"+p.substring(h):t._domain&&(p=p.substring(0,h)+t._domain+p.substring(h)))}}else p.includes("rpx")&&(p=p.replace(/[0-9.]*rpx/g,function(e){return parseFloat(e)*screenWidth/750+"px"}));p.includes("-webkit")||p.includes("-moz")||p.includes("-ms")||p.includes("-o")||p.includes("safe")?a.style+=";"+u+":"+p:d[u]&&!p.includes("import")&&d[u].includes("import")||(d[u]=p)}}"img"==e.name&&d.width&&d.width.includes("%")&&parseInt(d.width)>screenWidth&&(d.height="auto !important");for(var u in d)a.style+=";"+u+":"+d[u];a.style=a.style.substr(1),""==a.style&&(a.style=void 0),t._useAnchor&&a.id&&bubbling(t)},trustAttrs:trustAttrs,trustTags:trustTags,blockTags:blockTags,ignoreTags:ignoreTags,selfClosingTags:selfClosingTags,blankChar:blankChar,userAgentStyles:userAgentStyles,screenWidth:screenWidth};