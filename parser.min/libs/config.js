"use strict";function makeMap(e){for(var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=a,i=e.split(","),r=i.length;r--;)t[i[r]]=!0;return t}function bubbling(e){for(var a=e._STACK.length;a--;){if(richOnlyTags[e._STACK[a].name])return!1;e._STACK[a].c=1}return!0}var trustAttrs=makeMap("align,alt,app-id,author,autoplay,border,cellpadding,cellspacing,class,color,colspan,controls,data-src,dir,face,height,href,id,ignore,loop,media,muted,name,path,poster,rowspan,size,span,src,start,style,type,unit-id,unitId,width,xmlns"),trustTags=makeMap("a,abbr,ad,audio,b,blockquote,br,code,col,colgroup,dd,del,dl,dt,div,em,fieldset,h1,h2,h3,h4,h5,h6,hr,i,img,ins,label,legend,li,ol,p,q,source,span,strong,sub,sup,table,tbody,td,tfoot,th,thead,tr,title,ul,video"),blockTags=makeMap("address,article,aside,body,center,cite,footer,header,html,nav,pre,section"),ignoreTags=makeMap("area,base,basefont,canvas,circle,command,ellipse,embed,frame,head,iframe,input,isindex,keygen,line,link,map,meta,param,path,polygon,rect,script,source,svg,textarea,track,use,wbr"),richOnlyTags=makeMap("a,colgroup,fieldset,legend,picture,table,tbody,td,tfoot,th,thead,tr"),selfClosingTags=makeMap("area,base,basefont,br,col,circle,ellipse,embed,frame,hr,img,input,isindex,keygen,line,link,meta,param,path,polygon,rect,source,track,use,wbr"),blankChar=makeMap(" , ,\t,\r,\n,\f"),userAgentStyles={a:"color:#366092;word-break:break-all;padding:1.5px 0 1.5px 0",address:"font-style:italic",big:"display:inline;font-size:1.2em",blockquote:"background-color:#f6f6f6;border-left:3px solid #dbdbdb;color:#6c6c6c;padding:5px 0 5px 10px",center:"text-align:center",cite:"font-style:italic",dd:"margin-left:40px",img:"max-width:100%",mark:"background-color:yellow",picture:"max-width:100%",pre:"font-family:monospace;white-space:pre;overflow:scroll",s:"text-decoration:line-through",small:"display:inline;font-size:0.8em",u:"text-decoration:underline"},screenWidth=wx.getSystemInfoSync().screenWidth;wx.canIUse("editor")?(makeMap("bdi,bdo,caption,rt,ruby,pre",trustTags),makeMap("bdi,bdo,caption,rt,ruby,pre",richOnlyTags),ignoreTags.rp=!0,blockTags.pre=void 0):blockTags.caption=!0,module.exports={highlight:null,LabelHandler:function(e,a){var t=e.attrs,i=a.CssHandler.match(e.name,t,e)+(t.style||"");switch(e.name){case"div":case"p":t.align&&(i="text-align:"+t.align+";"+i,t.align=void 0);break;case"img":t["data-src"]&&(t.src=t.src||t["data-src"],t["data-src"]=void 0),t.width&&parseInt(t.width)>screenWidth&&(i+=";height:auto !important"),t.src&&!t.ignore&&(bubbling(a)?t.i=(a._imgNum++).toString():t.ignore="T");break;case"a":case"ad":bubbling(a);break;case"font":if(t.color&&(i="color:"+t.color+";"+i,t.color=void 0),t.face&&(i="font-family:"+t.face+";"+i,t.face=void 0),t.size){var r=parseInt(t.size);r<1?r=1:r>7&&(r=7);i="font-size:"+["xx-small","x-small","small","medium","large","x-large","xx-large"][r-1]+";"+i,t.size=void 0}break;case"video":case"audio":t.id?a["_"+e.name+"Num"]++:t.id=e.name+ ++a["_"+e.name+"Num"],"video"==e.name&&(t.width&&(i="width:"+(parseFloat(t.width)+t.width.includes("%")?"%":"px")+";"+i,t.width=void 0),t.height&&(i="height:"+(parseFloat(t.height)+t.height.includes("%")?"%":"px")+";"+i,t.height=void 0),a._videoNum>3&&(e.lazyLoad=!0)),t.source=[],t.src&&t.source.push(t.src),t.controls||t.autoplay||console.warn("存在没有 controls 属性的 "+e.name+" 标签，可能导致无法播放",e),bubbling(a);break;case"source":var s=a._STACK[a._STACK.length-1];if(!s||!t.src)break;if("video"==s.name||"audio"==s.name)s.attrs.source.push(t.src);else{var n,o=t.media;"picture"==s.name&&!s.attrs.src&&(!o||o.includes("px")&&(-1!=(n=o.indexOf("min-width"))&&-1!=(n=o.indexOf(":",n+8))&&screenWidth>parseInt(o.substring(n+1))||-1!=(n=o.indexOf("max-width"))&&-1!=(n=o.indexOf(":",n+8))&&screenWidth<parseInt(o.substring(n+1))))&&(s.attrs.src=t.src)}}var l=i.split(";"),d={};i="";for(var n=0,c=l.length;n<c;n++){var g=l[n].split(":");if(!(g.length<2)){var u=g[0].trim().toLowerCase(),p=g.slice(1).join(":").trim();if(p.includes("url")){var h=p.indexOf("(");if(-1!=h++){for(;'"'==p[h]||"'"==p[h]||blankChar[p[h]];)h++;"/"==p[h]&&("/"==p[h+1]?p=p.substring(0,h)+a._protocol+":"+p.substring(h):a._domain&&(p=p.substring(0,h)+a._domain+p.substring(h)))}}else p.includes("rpx")&&(p=p.replace(/[0-9.]*rpx/g,function(e){return parseFloat(e)*screenWidth/750+"px"}));p.includes("-webkit")||p.includes("-moz")||p.includes("-ms")||p.includes("-o")||p.includes("safe")?i+=";"+u+":"+p:d[u]&&!p.includes("import")&&d[u].includes("import")||(d[u]=p)}}"img"==e.name&&d.width&&d.width.includes("%")&&parseInt(d.width)>screenWidth&&(d.height="auto !important");for(var u in d)i+=";"+u+":"+d[u];i=i.substr(1),i&&(t.style=i),a._useAnchor&&t.id&&bubbling(a)},trustAttrs:trustAttrs,trustTags:trustTags,blockTags:blockTags,ignoreTags:ignoreTags,selfClosingTags:selfClosingTags,blankChar:blankChar,userAgentStyles:userAgentStyles,screenWidth:screenWidth};