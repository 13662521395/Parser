// 小程序富文本插件 https://github.com/jin-yufeng/Parser
"use strict";function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Component({data:{controls:{}},properties:{nodes:Array,lazyLoad:Boolean},detached:function(){this.observer&&this.observer.disconnect()},methods:{play:function(t){if(this.top.group&&this.top.group.pause(this.top.i),this.top.videoContexts.length>1&&this.top.data.autopause)for(var e=this.top.videoContexts.length;e--;)this.top.videoContexts[e].id!=t.currentTarget.id&&this.top.videoContexts[e].pause()},imgtap:function(t){var e=t.target.dataset.attrs;if(!e.ignore){var r=!0;if(this.top.triggerEvent("imgtap",{id:t.target.id,src:e.src,ignore:function(){return r=!1}}),r){if(this.top.group)return this.top.group.preview(this.top.i,e.i);var i=this.top.imgList,a=i[e.i]?i[e.i]:(i=[e.src],e.src);wx.previewImage({current:a,urls:i})}}},imglongtap:function(t){var e=t.target.dataset.attrs;e.ignore||this.top.triggerEvent("imglongtap",{id:t.target.id,src:e.src})},linkpress:function(t){var e=!0,r=t.currentTarget.dataset.attrs;r.ignore=function(){return e=!1},this.top.triggerEvent("linkpress",r),e&&(r["app-id"]?wx.navigateToMiniProgram({appId:r["app-id"],path:r.path}):r.href&&("#"==r.href[0]?this.top.navigateTo({id:r.href.substring(1)}):0==r.href.indexOf("http")||0==r.href.indexOf("//")?wx.setClipboardData({data:r.href,success:function(){return wx.showToast({title:"链接已复制"})}}):wx.navigateTo({url:r.href})))},error:function(t){var e;if("Video"==t.target.dataset.from||"Audio"==t.target.dataset.from){var r=this.data.controls[t.target.id]?this.data.controls[t.target.id]+1:1;if(r<t.target.dataset.source.length)return this.setData(_defineProperty({},"controls."+t.target.id,r));e=wx["create"+t.target.dataset.from+"Context"](t.target.id,this)}this.top&&this.top.triggerEvent("error",{source:t.target.dataset.from.toLowerCase(),target:t.target,errMsg:t.detail.errMsg,errCode:t.detail.errCode,context:e})},loadVideo:function(t){for(var e=this.data.nodes.length;e--;){var r;if(this.data.nodes[e].attrs.id==t.currentTarget.id)return this.setData((r={},_defineProperty(r,"nodes["+e+"].lazyLoad",!1),_defineProperty(r,"nodes["+e+"].attrs.autoplay",!0),r))}}}});