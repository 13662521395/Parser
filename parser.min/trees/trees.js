// 小程序富文本插件 https://github.com/jin-yufeng/Parser
"use strict";function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}Component({data:{controls:{}},properties:{nodes:Array},methods:{play:function(t){if(this._top.group&&this._top.group.pause(this._top.i),this._top.videoContexts.length>1&&this._top.data.autopause)for(var e=this._top.videoContexts.length;e--;)this._top.videoContexts[e].id!=t.currentTarget.id&&this._top.videoContexts[e].pause()},imgtap:function(t){var e=t.currentTarget.dataset.attrs;if(!e.ignore){var r=!0;if(this._top.triggerEvent("imgtap",{id:t.currentTarget.id,src:e.src,ignore:function(){return r=!1}}),r){if(this._top.group)return this._top.group.preview(this._top.i,e.i);var i=this._top.imgList,o=i[e.i]?i[e.i]:(i=[e.src],e.src);wx.previewImage({current:o,urls:i})}}},imglongtap:function(t){var e=t.currentTarget.dataset.attrs;e.ignore||this._top.triggerEvent("imglongtap",{id:t.currentTarget.id,src:e.src})},linkpress:function(t){var e=!0,r=t.currentTarget.dataset.attrs;r.ignore=function(){return e=!1},this._top.triggerEvent("linkpress",r),e&&(r["app-id"]?wx.navigateToMiniProgram({appId:r["app-id"],path:r.path}):r.href&&("#"==r.href[0]?this._top.navigateTo({id:r.href.substring(1)}):0==r.href.indexOf("http")||0==r.href.indexOf("//")?wx.setClipboardData({data:r.href,success:function(){wx.showToast({title:"链接已复制"})}}):wx.navigateTo({url:r.href})))},error:function(t){var e,r=t.currentTarget;if("Video"==r.dataset.from||"Audio"==r.dataset.from){var i=this.data.controls[r.id]?this.data.controls[r.id].index+1:1;if(i<r.dataset.source.length)return this.setData(_defineProperty({},"controls."+r.id,i));e=wx["create"+r.dataset.from+"Context"](r.id,this)}this._top&&this._top.triggerEvent("error",{source:r.dataset.from.toLowerCase(),target:r,errMsg:t.detail.errMsg,errCode:t.detail.errCode,context:e})},loadVideo:function(t){for(var e=this.data.nodes.length;e--;){var r;if(this.data.nodes[e].attrs.id==t.currentTarget.id)return this.setData((r={},_defineProperty(r,"nodes["+e+"].lazyLoad",!1),_defineProperty(r,"nodes["+e+"].attrs.autoplay",!0),r))}}},detached:function(){this._observer&&this._observer.disconnect()}});